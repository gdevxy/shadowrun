<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title th:text="${title} ?: 'ShadowRun GM - Command Center'">ShadowRun GM - Command Center</title>

	<!-- Bootstrap 5 CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

	<!-- FontAwesome -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

	<!-- Tactical Glass Theme CSS -->
	<link rel="stylesheet" th:href="@{/css/tactical-theme.css}">
</head>
<body>

	<div class="app-container">
		<!-- Sidebar -->
		<aside id="sidebar" class="sidebar">
			<div class="sidebar-brand">
				<h2>
					<span class="brand-icon"></span>
					SHADOWRUN GM
				</h2>
			</div>

			<nav class="sidebar-nav">
				<div class="nav-section">
					<div class="nav-section-title">Main</div>
					<a href="/" class="nav-item" th:classappend="${currentPage == 'dashboard' ? 'active' : ''}">
						<i class="fas fa-th-large"></i>
						<span>Dashboard</span>
					</a>
				</div>

				<div class="nav-section">
					<div class="nav-section-title">Campaign</div>
					<a href="/campaign" class="nav-item" th:classappend="${currentPage == 'campaign' ? 'active' : ''}">
						<i class="fas fa-book-open"></i>
						<span>Active Campaign</span>
					</a>
					<a href="/sessions" class="nav-item" th:classappend="${currentPage == 'sessions' ? 'active' : ''}">
						<i class="fas fa-clipboard-list"></i>
						<span>Session Logs</span>
					</a>
				</div>

				<div class="nav-section">
					<div class="nav-section-title">Database</div>
					<a href="/personnel" class="nav-item" th:classappend="${currentPage == 'personnel' ? 'active' : ''}">
						<i class="fas fa-users"></i>
						<span>Personnel</span>
					</a>
					<a href="/locations" class="nav-item" th:classappend="${currentPage == 'locations' ? 'active' : ''}">
						<i class="fas fa-map-marked-alt"></i>
						<span>Locations</span>
					</a>
					<a href="/bestiary" class="nav-item" th:classappend="${currentPage == 'bestiary' ? 'active' : ''}">
						<i class="fas fa-skull-crossbones"></i>
						<span>Bestiary</span>
					</a>
				</div>

				<div class="nav-section">
					<div class="nav-section-title">Tools</div>
					<a href="/matrix" class="nav-item" th:classappend="${currentPage == 'matrix' ? 'active' : ''}">
						<i class="fas fa-robot"></i>
						<span>AI Assistant</span>
					</a>
				</div>
			</nav>

			<div class="sidebar-footer">
				<div class="status-indicator">
					<span class="status-dot"></span>
					<span>System Online</span>
				</div>
			</div>
		</aside>

		<!-- Main Content -->
		<main class="main-content">
			<!-- Top Bar -->
			<div class="top-bar">
				<div class="top-bar-left">
					<button id="mobileSidebarToggle" class="btn btn-link text-white d-md-none">
						<i class="fas fa-bars"></i>
					</button>
					<h1 th:text="${pageTitle} ?: 'Dashboard'">Dashboard</h1>
				</div>
				<div class="top-bar-right">
					<div class="status-indicator">
						<i class="far fa-clock"></i>
						<span id="currentTime">--:--</span>
					</div>
					<div class="status-indicator">
						<i class="far fa-calendar"></i>
						<span id="currentDate">-- --- ----</span>
					</div>
					<div class="status-indicator">
						<span class="status-dot"></span>
						<span>Secure</span>
					</div>
				</div>
			</div>

			<!-- Content Area -->
			<div class="content-area">
				<div layout:fragment="content">
					<!-- Page content will be injected here -->
				</div>
			</div>
		</main>
	</div>

	<!-- Bootstrap JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

	<!-- Custom JS -->
	<script>
		// Current Date/Time Display
		function updateDateTime() {
			const now = new Date();

			// Time
			const timeStr = now.toLocaleTimeString('en-US', {
				hour: '2-digit',
				minute: '2-digit',
				hour12: false
			});
			document.getElementById('currentTime').textContent = timeStr;

			// Date
			const dateStr = now.toLocaleDateString('en-US', {
				day: '2-digit',
				month: 'short',
				year: 'numeric'
			});
			document.getElementById('currentDate').textContent = dateStr;
		}

		updateDateTime();
		setInterval(updateDateTime, 1000);

		// Mobile Sidebar Toggle
		const mobileSidebarToggle = document.getElementById('mobileSidebarToggle');
		const sidebar = document.getElementById('sidebar');

		if (mobileSidebarToggle) {
			mobileSidebarToggle.addEventListener('click', function() {
				sidebar.classList.toggle('mobile-open');
			});
		}

		// Close sidebar when clicking outside on mobile
		document.addEventListener('click', function(e) {
			if (window.innerWidth <= 768) {
				if (!sidebar.contains(e.target) &&
					mobileSidebarToggle &&
					!mobileSidebarToggle.contains(e.target) &&
					sidebar.classList.contains('mobile-open')) {
					sidebar.classList.remove('mobile-open');
				}
			}
		});
	</script>
</body>
</html>
